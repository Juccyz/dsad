----------------------------------------------------------
-- Party Manager System (Invite, Notification, Kick, Persistent Party, Auto Teleport Loop)
----------------------------------------------------------

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TeleportService = game:GetService("TeleportService")
local TweenService = game:GetService("TweenService")
local localPlayer = Players.LocalPlayer
local playerGui = localPlayer:WaitForChild("PlayerGui")
local placeId = game.PlaceId

----------------------------------------------------------
-- Party Data (Config)
----------------------------------------------------------
-- partyData.partyMembers ‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡∏≠‡∏á {Name = <string>, UserId = <number>}
local partyData = {
	partyName = "",
	hostJobId = "",
	isCreated = false,
	partyMembers = {}  -- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á; Host ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏≠‡∏ô Create Party
}

-- ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Joiner: flag ‡∏ß‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô party‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
local inParty = false

----------------------------------------------------------
-- Save Party Config ‡∏•‡∏á‡πÉ‡∏ô Workspace (Persistent: ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå "chat gpt")
----------------------------------------------------------
local function savePartyConfig()
	-- ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå "chat gpt" ‡πÉ‡∏ô Workspace (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö persistent party data)
	local folder = workspace:FindFirstChild("chat gpt")
	if not folder then
		folder = Instance.new("Folder")
		folder.Name = "chat gpt"
		folder.Parent = workspace
	end

	-- ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å HostJobId
	local jobIdValue = folder:FindFirstChild("HostJobId")
	if not jobIdValue then
		jobIdValue = Instance.new("StringValue")
		jobIdValue.Name = "HostJobId"
		jobIdValue.Parent = folder
	end
	jobIdValue.Value = partyData.hostJobId

	-- ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Party ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
	local isCreatedValue = folder:FindFirstChild("IsCreated")
	if not isCreatedValue then
		isCreatedValue = Instance.new("BoolValue")
		isCreatedValue.Name = "IsCreated"
		isCreatedValue.Parent = folder
	end
	isCreatedValue.Value = partyData.isCreated

	-- ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÉ‡∏ô Party
	local membersFolder = folder:FindFirstChild("PartyMembers")
	if not membersFolder then
		membersFolder = Instance.new("Folder")
		membersFolder.Name = "PartyMembers"
		membersFolder.Parent = folder
	end
	-- ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÄ‡∏Å‡πà‡∏≤
	for _, child in pairs(membersFolder:GetChildren()) do
		child:Destroy()
	end
	-- ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å (‡πÄ‡∏Å‡πá‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ß‡πâ‡πÄ‡∏õ‡πá‡∏ô StringValue)
	for _, member in ipairs(partyData.partyMembers) do
		local memberValue = Instance.new("StringValue")
		memberValue.Name = member.Name
		memberValue.Value = member.Name
		memberValue.Parent = membersFolder
	end

	print("Auto Save: Party Config updated in workspace 'chat gpt'!")
end

----------------------------------------------------------
-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á Notification (‡∏û‡∏£‡πâ‡∏≠‡∏° Tween fade-out)
----------------------------------------------------------
local function showNotification(message)
	-- ‡∏™‡∏£‡πâ‡∏≤‡∏á ScreenGui (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ)
	local notifGui = playerGui:FindFirstChild("NotificationGui")
	if not notifGui then
		notifGui = Instance.new("ScreenGui")
		notifGui.Name = "NotificationGui"
		notifGui.ResetOnSpawn = false
		notifGui.Parent = playerGui
	end

	-- ‡∏™‡∏£‡πâ‡∏≤‡∏á Notification Frame
	local notifFrame = Instance.new("TextLabel")
	notifFrame.Size = UDim2.new(0, 250, 0, 50)
	notifFrame.Position = UDim2.new(0.5, -125, 0.1, 0)
	notifFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	notifFrame.BackgroundTransparency = 0.3
	notifFrame.TextColor3 = Color3.new(1, 1, 1)
	notifFrame.TextScaled = true
	notifFrame.Font = Enum.Font.GothamBold
	notifFrame.Text = message
	notifFrame.Parent = notifGui

	-- Tween: fade out ‡πÅ‡∏•‡πâ‡∏ß destroy
	local tweenInfo = TweenInfo.new(2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out, 0, false, 1)
	local tween = TweenService:Create(notifFrame, tweenInfo, {TextTransparency = 1, BackgroundTransparency = 1})
	tween:Play()
	tween.Completed:Connect(function()
		notifFrame:Destroy()
	end)
end

----------------------------------------------------------
-- Update Party Icons UI (‡πÅ‡∏™‡∏î‡∏á HeadShot ‡πÅ‡∏•‡∏∞‡∏ñ‡πâ‡∏≤ Host ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏° Kick)
----------------------------------------------------------
local function updatePartyIcons()
	-- ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏Å‡πà‡∏≤‡πÉ‡∏ô partySlotHolder
	for _, child in pairs(partySlotHolder:GetChildren()) do
		if child:IsA("ImageLabel") then
			child:Destroy()
		end
	end

	-- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÉ‡∏ô Party
	for i, member in ipairs(partyData.partyMembers) do
		-- ‡∏î‡∏∂‡∏á HeadShot Thumbnail
		local thumb, isReady = Players:GetUserThumbnailAsync(member.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size100x100)
		local icon = Instance.new("ImageLabel")
		icon.Name = member.Name .. "_Icon"
		icon.Size = UDim2.new(0, 32, 0, 32)
		icon.Position = UDim2.new(0, (i - 1) * 38, 0, 0)
		icon.Image = thumb
		icon.BackgroundColor3 = Color3.new(1, 1, 1)
		icon.Parent = partySlotHolder

		-- ‡∏ñ‡πâ‡∏≤ localPlayer ‡πÄ‡∏õ‡πá‡∏ô Host (Party Leader) ‡πÅ‡∏•‡∏∞ member ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà Host ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏° Kick
		if partyData.isCreated and localPlayer.Name == partyData.partyMembers[1].Name and member.Name ~= localPlayer.Name then
			local kickButton = Instance.new("TextButton")
			kickButton.Name = "KickButton"
			kickButton.Size = UDim2.new(0, 16, 0, 16)
			kickButton.Position = UDim2.new(1, -16, 0, 0)
			kickButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
			kickButton.Text = "X"
			kickButton.TextColor3 = Color3.new(1, 1, 1)
			kickButton.Font = Enum.Font.GothamBold
			kickButton.TextSize = 12
			kickButton.Parent = icon

			-- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î Kick: ‡∏•‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å party
			kickButton.MouseButton1Click:Connect(function()
				for index, m in ipairs(partyData.partyMembers) do
					if m.Name == member.Name then
						table.remove(partyData.partyMembers, index)
						showNotification(member.Name .. " has been kicked from the party.")
						break
					end
				end
				updatePartyIcons()
				savePartyConfig()
			end)
		end
	end
end

----------------------------------------------------------
-- UI ‡∏´‡∏•‡∏±‡∏Å: Party Manager
----------------------------------------------------------
local partyGUI = Instance.new("ScreenGui")
partyGUI.Name = "PartyGUI"
partyGUI.ResetOnSpawn = false
partyGUI.Enabled = true
partyGUI.Parent = playerGui

-- Main Frame (‡πÅ‡∏™‡∏î‡∏á Party Manager, Slots ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å)
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 300, 0, 120)
mainFrame.Position = UDim2.new(0, 50, 0, 100)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.Parent = partyGUI

-- Title: Party Manager
local titleLabel = Instance.new("TextLabel")
titleLabel.Name = "TitleLabel"
titleLabel.Size = UDim2.new(1, -40, 0, 30)
titleLabel.Position = UDim2.new(0, 10, 0, 10)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "Party Manager"
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 14
titleLabel.Parent = mainFrame

-- Icon (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ä‡πâ‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥)
local wifiIcon = Instance.new("TextLabel")
wifiIcon.Name = "WifiIcon"
wifiIcon.Size = UDim2.new(0, 24, 0, 24)
wifiIcon.Position = UDim2.new(1, -30, 0, 10)
wifiIcon.BackgroundTransparency = 1
wifiIcon.Text = "üì∂"
wifiIcon.TextColor3 = Color3.fromRGB(255, 0, 0)
wifiIcon.Font = Enum.Font.GothamBold
wifiIcon.TextSize = 14
wifiIcon.Parent = mainFrame

-- Party Slot Holder ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
local partySlotHolder = Instance.new("Frame")
partySlotHolder.Name = "PartySlotHolder"
partySlotHolder.Size = UDim2.new(1, -20, 0, 40)
partySlotHolder.Position = UDim2.new(0, 10, 0, 50)
partySlotHolder.BackgroundTransparency = 1
partySlotHolder.Parent = mainFrame

-- ‡∏õ‡∏∏‡πà‡∏° "+" ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π Create/Join
local plusButton = Instance.new("TextButton")
plusButton.Name = "PlusButton"
plusButton.Size = UDim2.new(0, 32, 0, 32)
plusButton.Position = UDim2.new(1, -42, 0, 50)
plusButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
plusButton.Text = "+"
plusButton.TextColor3 = Color3.fromRGB(0, 0, 0)
plusButton.Font = Enum.Font.GothamBold
plusButton.TextSize = 24
plusButton.Parent = mainFrame

----------------------------------------------------------
-- Frame: Create Party / Join Party Options
----------------------------------------------------------
local partyOptionsFrame = Instance.new("Frame")
partyOptionsFrame.Name = "PartyOptionsFrame"
partyOptionsFrame.Size = UDim2.new(0, 300, 0, 120)
partyOptionsFrame.Position = UDim2.new(0, 50, 0, 240)
partyOptionsFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
partyOptionsFrame.Visible = false
partyOptionsFrame.Parent = partyGUI

local createPartyButton = Instance.new("TextButton")
createPartyButton.Name = "CreatePartyButton"
createPartyButton.Size = UDim2.new(0, 120, 0, 40)
createPartyButton.Position = UDim2.new(0, 10, 0, 10)
createPartyButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
createPartyButton.Text = "Create Party"
createPartyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
createPartyButton.Font = Enum.Font.GothamBold
createPartyButton.TextSize = 14
createPartyButton.Parent = partyOptionsFrame

local joinPartyButton = Instance.new("TextButton")
joinPartyButton.Name = "JoinPartyButton"
joinPartyButton.Size = UDim2.new(0, 120, 0, 40)
joinPartyButton.Position = UDim2.new(0, 160, 0, 10)
joinPartyButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
joinPartyButton.Text = "Join Party"
joinPartyButton.TextColor3 = Color3.fromRGB(0, 0, 0)
joinPartyButton.Font = Enum.Font.GothamBold
joinPartyButton.TextSize = 14
joinPartyButton.Parent = partyOptionsFrame

----------------------------------------------------------
-- Frame: Party Created Screen (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Host)
----------------------------------------------------------
local partyCreatedFrame = Instance.new("Frame")
partyCreatedFrame.Name = "PartyCreatedFrame"
partyCreatedFrame.Size = UDim2.new(0, 300, 0, 160)
partyCreatedFrame.Position = UDim2.new(0, 50, 0, 380)
partyCreatedFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
partyCreatedFrame.Visible = false
partyCreatedFrame.Parent = partyGUI

local jobIdLabel = Instance.new("TextLabel")
jobIdLabel.Name = "JobIdLabel"
jobIdLabel.Size = UDim2.new(0, 200, 0, 30)
jobIdLabel.Position = UDim2.new(0, 10, 0, 10)
jobIdLabel.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
jobIdLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
jobIdLabel.Font = Enum.Font.Gotham
jobIdLabel.TextSize = 14
jobIdLabel.Text = "Job ID: ???"
jobIdLabel.Parent = partyCreatedFrame

local copyButton = Instance.new("TextButton")
copyButton.Name = "CopyButton"
copyButton.Size = UDim2.new(0, 30, 0, 30)
copyButton.Position = UDim2.new(0, 220, 0, 10)
copyButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
copyButton.Text = "üìã"
copyButton.TextColor3 = Color3.fromRGB(0, 0, 0)
copyButton.Font = Enum.Font.Gotham
copyButton.TextSize = 14
copyButton.Parent = partyCreatedFrame

local disbandButton = Instance.new("TextButton")
disbandButton.Name = "DisbandButton"
disbandButton.Size = UDim2.new(0, 80, 0, 40)
disbandButton.Position = UDim2.new(0, 10, 0, 60)
disbandButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
disbandButton.Text = "Disband"
disbandButton.TextColor3 = Color3.fromRGB(255, 255, 255)
disbandButton.Font = Enum.Font.GothamBold
disbandButton.TextSize = 14
disbandButton.Parent = partyCreatedFrame

-- ‡∏õ‡∏∏‡πà‡∏° Invite Friends (‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Host)
local inviteFriendsButton = Instance.new("TextButton")
inviteFriendsButton.Name = "InviteFriendsButton"
inviteFriendsButton.Size = UDim2.new(0, 120, 0, 40)
inviteFriendsButton.Position = UDim2.new(0, 100, 0, 60)
inviteFriendsButton.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
inviteFriendsButton.Text = "Invite Friends"
inviteFriendsButton.TextColor3 = Color3.fromRGB(255, 255, 255)
inviteFriendsButton.Font = Enum.Font.GothamBold
inviteFriendsButton.TextSize = 14
inviteFriendsButton.Parent = partyCreatedFrame

----------------------------------------------------------
-- Frame: Join Party Screen (‡∏Å‡∏£‡∏≠‡∏Å Job ID ‡∏Ç‡∏≠‡∏á Host)
----------------------------------------------------------
local joinPartyFrame = Instance.new("Frame")
joinPartyFrame.Name = "JoinPartyFrame"
joinPartyFrame.Size = UDim2.new(0, 300, 0, 120)
joinPartyFrame.Position = UDim2.new(0, 50, 0, 560)
joinPartyFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
joinPartyFrame.Visible = false
joinPartyFrame.Parent = partyGUI

local jobIdTextBox = Instance.new("TextBox")
jobIdTextBox.Name = "JobIdTextBox"
jobIdTextBox.Size = UDim2.new(0, 200, 0, 30)
jobIdTextBox.Position = UDim2.new(0, 10, 0, 10)
jobIdTextBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
jobIdTextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
jobIdTextBox.Font = Enum.Font.Gotham
jobIdTextBox.TextSize = 14
jobIdTextBox.PlaceholderText = "Enter Party Job ID"
jobIdTextBox.Parent = joinPartyFrame

local joinButton = Instance.new("TextButton")
joinButton.Name = "JoinButton"
joinButton.Size = UDim2.new(0, 80, 0, 30)
joinButton.Position = UDim2.new(0, 220, 0, 10)
joinButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
joinButton.Text = "Join"
joinButton.TextColor3 = Color3.fromRGB(0, 0, 0)
joinButton.Font = Enum.Font.GothamBold
joinButton.TextSize = 14
joinButton.Parent = joinPartyFrame

----------------------------------------------------------
-- Frame: Invite Friends (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Host ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡πÄ‡∏ä‡∏¥‡∏ç)
----------------------------------------------------------
local inviteFrame = Instance.new("Frame")
inviteFrame.Name = "InviteFrame"
inviteFrame.Size = UDim2.new(0, 300, 0, 80)
inviteFrame.Position = UDim2.new(0, 50, 0, 550)
inviteFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
inviteFrame.Visible = false
inviteFrame.Parent = partyGUI

local friendNameTextBox = Instance.new("TextBox")
friendNameTextBox.Name = "FriendNameTextBox"
friendNameTextBox.Size = UDim2.new(0, 200, 0, 30)
friendNameTextBox.Position = UDim2.new(0, 10, 0, 10)
friendNameTextBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
friendNameTextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
friendNameTextBox.Font = Enum.Font.Gotham
friendNameTextBox.TextSize = 14
friendNameTextBox.PlaceholderText = "Enter Friend's Name"
friendNameTextBox.Parent = inviteFrame

local sendInviteButton = Instance.new("TextButton")
sendInviteButton.Name = "SendInviteButton"
sendInviteButton.Size = UDim2.new(0, 80, 0, 30)
sendInviteButton.Position = UDim2.new(0, 220, 0, 10)
sendInviteButton.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
sendInviteButton.Text = "Invite"
sendInviteButton.TextColor3 = Color3.fromRGB(255, 255, 255)
sendInviteButton.Font = Enum.Font.GothamBold
sendInviteButton.TextSize = 14
sendInviteButton.Parent = inviteFrame

----------------------------------------------------------
-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
----------------------------------------------------------
-- Toggle ‡πÄ‡∏°‡∏ô‡∏π Create/Join ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "+"
local function togglePartyOptions()
	-- ‡πÉ‡∏ä‡πâ Tween ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ slide ‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏≠‡∏Å
	partyOptionsFrame.Visible = not partyOptionsFrame.Visible
	local startPos, endPos
	if partyOptionsFrame.Visible then
		startPos = UDim2.new(0, 50, 0, 240 - 50)
		endPos = UDim2.new(0, 50, 0, 240)
	else
		startPos = partyOptionsFrame.Position
		endPos = UDim2.new(0, 50, 0, 240 - 50)
	end
	partyOptionsFrame.Position = startPos
	local tween = TweenService:Create(partyOptionsFrame, TweenInfo.new(0.3), {Position = endPos})
	tween:Play()
end
plusButton.MouseButton1Click:Connect(togglePartyOptions)

-- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î "Create Party"
createPartyButton.MouseButton1Click:Connect(function()
	partyOptionsFrame.Visible = false
	partyCreatedFrame.Visible = true

	local currentJobId = game.JobId
	partyData.hostJobId = currentJobId
	partyData.isCreated = true
	-- Host ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å
	partyData.partyMembers = { {Name = localPlayer.Name, UserId = localPlayer.UserId} }
	jobIdLabel.Text = "Job ID: " .. currentJobId
	showNotification("Party created! Job ID: " .. currentJobId)
	print("Create Party - Job ID:", currentJobId)

	inParty = true

	updatePartyIcons()
	savePartyConfig()
end)

-- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î "Join Party"
joinPartyButton.MouseButton1Click:Connect(function()
	partyOptionsFrame.Visible = false
	joinPartyFrame.Visible = true
end)

-- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "Copy" (‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Job ID)
copyButton.MouseButton1Click:Connect(function()
	local textToCopy = jobIdLabel.Text:gsub("Job ID: ", "")
	setclipboard(textToCopy)
	print("Copied Job ID:", textToCopy)
end)

-- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "Disband" (‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å Party)
disbandButton.MouseButton1Click:Connect(function()
	print("Disbanding party...")
	partyData.hostJobId = ""
	partyData.isCreated = false
	partyData.partyMembers = {}
	partyCreatedFrame.Visible = false
	inParty = false
	updatePartyIcons()
	savePartyConfig()
	showNotification("Party disbanded.")
end)

-- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "Join" (‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Job ID) ‡πÉ‡∏´‡πâ Teleport ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ Job ID ‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å
joinButton.MouseButton1Click:Connect(function()
	local targetJobId = jobIdTextBox.Text
	if targetJobId ~= "" then
		print("Joining party with Job ID:", targetJobId)
		-- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ local party data (Joiner)
		partyData.hostJobId = targetJobId
		partyData.isCreated = false  -- joiner ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà host
		-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô partyMembers (Joiner)
		partyData.partyMembers = { {Name = targetJobId, UserId = 0} } -- placeholder; ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á ‡∏Ñ‡∏ß‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡πà‡∏≤‡∏ô TeleportData
		inParty = true
		savePartyConfig()
		TeleportService:TeleportToPlaceInstance(placeId, targetJobId, localPlayer)
	else
		print("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Job ID ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á")
	end
end)

-- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "Invite Friends" (‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Host)
inviteFriendsButton.MouseButton1Click:Connect(function()
	-- Toggle ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î inviteFrame
	inviteFrame.Visible = not inviteFrame.Visible
end)

-- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î "Invite" ‡πÉ‡∏ô inviteFrame
sendInviteButton.MouseButton1Click:Connect(function()
	local friendName = friendNameTextBox.Text
	if friendName ~= "" then
		-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ friend ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
		local friendPlayer = Players:FindFirstChild(friendName)
		if friendPlayer then
			-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô party ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
			local exists = false
			for _, member in ipairs(partyData.partyMembers) do
				if member.Name == friendName then
					exists = true
					break
				end
			end
			if not exists then
				table.insert(partyData.partyMembers, {Name = friendPlayer.Name, UserId = friendPlayer.UserId})
				showNotification("Invitation sent to " .. friendPlayer.Name)
				updatePartyIcons()
				savePartyConfig()
			else
				showNotification(friendPlayer.Name .. " is already in the party.")
			end
		else
			showNotification("Player " .. friendName .. " not found.")
		end
	else
		showNotification("Please enter a friend's name.")
	end
	-- clear ‡∏ä‡πà‡∏≠‡∏á input
	friendNameTextBox.Text = ""
	inviteFrame.Visible = false
end)

-- ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° P ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î/‡∏ã‡πà‡∏≠‡∏ô UI ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
local isPartyGUIVisible = true
local function togglePartyGUI()
	isPartyGUIVisible = not isPartyGUIVisible
	partyGUI.Enabled = isPartyGUIVisible
end
UserInputService.InputBegan:Connect(function(input, gameProcessed)
	if gameProcessed then return end
	if input.KeyCode == Enum.KeyCode.P then
		togglePartyGUI()
	end
end)

----------------------------------------------------------
-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Party ‡πÅ‡∏•‡∏∞ Teleport Loop (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Joiner)
----------------------------------------------------------
local function startTeleportLoop()
	-- ‡∏ñ‡πâ‡∏≤ localPlayer ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà Host ‡πÅ‡∏ï‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Ç‡∏≠‡∏á party ‡πÉ‡∏´‡πâ loop teleport ‡∏ó‡∏∏‡∏Å‡πÜ 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
	spawn(function()
		while inParty do
			wait(30)
			-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ party config ‡πÉ‡∏ô workspace ‡∏¢‡∏±‡∏á‡∏°‡∏µ HostJobId ‡πÅ‡∏•‡∏∞‡∏ñ‡πâ‡∏≤ JobId ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
			local folder = workspace:FindFirstChild("chat gpt")
			if folder then
				local jobIdValue = folder:FindFirstChild("HostJobId")
				if jobIdValue and jobIdValue.Value ~= "" and game.JobId ~= jobIdValue.Value then
					print("Teleporting to Host's server: " .. jobIdValue.Value)
					TeleportService:TeleportToPlaceInstance(placeId, jobIdValue.Value, localPlayer)
				end
			end
		end
	end)
end

-- ‡πÄ‡∏£‡∏¥‡πà‡∏° Teleport Loop ‡∏´‡∏≤‡∏Å localPlayer ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà Host ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å party
if not partyData.isCreated then
	-- delay ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• party ‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î
	delay(5, function()
		if inParty then
			startTeleportLoop()
		end
	end)
end

----------------------------------------------------------
-- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô‡πÄ‡∏Å‡∏° (PlayerAdded) 
-- ‡∏ñ‡πâ‡∏≤ party ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà (‡πÇ‡∏î‡∏¢ Host) ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÉ‡∏´‡∏°‡πà (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô Host)
----------------------------------------------------------
Players.PlayerAdded:Connect(function(newPlayer)
	if partyData.isCreated and newPlayer.Name ~= localPlayer.Name then
		local exists = false
		for _, member in ipairs(partyData.partyMembers) do
			if member.Name == newPlayer.Name then
				exists = true
				break
			end
		end
		if not exists then
			table.insert(partyData.partyMembers, {Name = newPlayer.Name, UserId = newPlayer.UserId})
			showNotification(newPlayer.Name .. " joined the party!")
			updatePartyIcons()
			savePartyConfig()
		end
	end
end)

-- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏Å‡∏°
Players.PlayerRemoving:Connect(function(leavingPlayer)
	for index, member in ipairs(partyData.partyMembers) do
		if member.Name == leavingPlayer.Name then
			table.remove(partyData.partyMembers, index)
			showNotification(leavingPlayer.Name .. " left the party.")
			updatePartyIcons()
			savePartyConfig()
			break
		end
	end
end)

print("Party Manager UI Loaded")
